import{r,j as o,d as Ne,o as De,e as re,t as ae,s as Ie,f as Fe}from"./main-t1m2ejxw.js";import{c as Z,L as Ae,B as Be}from"./button-DvXn5wo_.js";import{u as We,C as _e,a as Le}from"./useForm-yjHLKOsa.js";var He=Object.defineProperty,Ve=Object.defineProperties,Ge=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,be=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,ge=(e,t,l)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,$e=(e,t)=>{for(var l in t||(t={}))be.call(t,l)&&ge(e,l,t[l]);if(Q)for(var l of Q(t))xe.call(t,l)&&ge(e,l,t[l]);return e},ze=(e,t)=>Ve(e,Ge(t)),qe=(e,t)=>{var l={};for(var u in e)be.call(e,u)&&t.indexOf(u)<0&&(l[u]=e[u]);if(e!=null&&Q)for(var u of Q(e))t.indexOf(u)<0&&xe.call(e,u)&&(l[u]=e[u]);return l};function Ye(e){let t=setTimeout(e,0),l=setTimeout(e,10),u=setTimeout(e,50);return[t,l,u]}function Ze(e){let t=r.useRef();return r.useEffect(()=>{t.current=e}),t.current}var Je=18,we=40,Ke=`${we}px`,Qe=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Ue({containerRef:e,inputRef:t,pushPasswordManagerStrategy:l,isFocused:u}){let[f,i]=r.useState(!1),[h,S]=r.useState(!1),[y,L]=r.useState(!1),H=r.useMemo(()=>l==="none"?!1:(l==="increase-width"||l==="experimental-no-flickering")&&f&&h,[f,h,l]),F=r.useCallback(()=>{let g=e.current,k=t.current;if(!g||!k||y||l==="none")return;let w=g,C=w.getBoundingClientRect().left+w.offsetWidth,A=w.getBoundingClientRect().top+w.offsetHeight/2,c=C-Je,V=A;document.querySelectorAll(Qe).length===0&&document.elementFromPoint(c,V)===g||(i(!0),L(!0))},[e,t,y,l]);return r.useEffect(()=>{let g=e.current;if(!g||l==="none")return;function k(){let C=window.innerWidth-g.getBoundingClientRect().right;S(C>=we)}k();let w=setInterval(k,1e3);return()=>{clearInterval(w)}},[e,l]),r.useEffect(()=>{let g=u||document.activeElement===t.current;if(l==="none"||!g)return;let k=setTimeout(F,0),w=setTimeout(F,2e3),C=setTimeout(F,5e3),A=setTimeout(()=>{L(!0)},6e3);return()=>{clearTimeout(k),clearTimeout(w),clearTimeout(C),clearTimeout(A)}},[t,u,l,F]),{hasPWMBadge:f,willPushPWMBadge:H,PWM_BADGE_SPACE_WIDTH:Ke}}var je=r.createContext({}),Se=r.forwardRef((e,t)=>{var l=e,{value:u,onChange:f,maxLength:i,textAlign:h="left",pattern:S,placeholder:y,inputMode:L="numeric",onComplete:H,pushPasswordManagerStrategy:F="increase-width",pasteTransformer:g,containerClassName:k,noScriptCSSFallback:w=Xe,render:C,children:A}=l,c=qe(l,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),V,le,oe,ie,se;let[Ee,ye]=r.useState(typeof c.defaultValue=="string"?c.defaultValue:""),d=u??Ee,R=Ze(d),G=r.useCallback(n=>{f?.(n),ye(n)},[f]),E=r.useMemo(()=>S?typeof S=="string"?new RegExp(S):S:null,[S]),p=r.useRef(null),U=r.useRef(null),X=r.useRef({value:d,onChange:G,isIOS:typeof window<"u"&&((le=(V=window?.CSS)==null?void 0:V.supports)==null?void 0:le.call(V,"-webkit-touch-callout","none"))}),J=r.useRef({prev:[(oe=p.current)==null?void 0:oe.selectionStart,(ie=p.current)==null?void 0:ie.selectionEnd,(se=p.current)==null?void 0:se.selectionDirection]});r.useImperativeHandle(t,()=>p.current,[]),r.useEffect(()=>{let n=p.current,a=U.current;if(!n||!a)return;X.current.value!==n.value&&X.current.onChange(n.value),J.current.prev=[n.selectionStart,n.selectionEnd,n.selectionDirection];function m(){if(document.activeElement!==n){z(null),q(null);return}let s=n.selectionStart,v=n.selectionEnd,K=n.selectionDirection,j=n.maxLength,N=n.value,P=J.current.prev,M=-1,O=-1,D;if(N.length!==0&&s!==null&&v!==null){let Oe=s===v,Re=s===N.length&&N.length<j;if(Oe&&!Re){let I=s;if(I===0)M=0,O=1,D="forward";else if(I===j)M=I-1,O=I,D="backward";else if(j>1&&N.length>1){let ne=0;if(P[0]!==null&&P[1]!==null){D=I<P[1]?"backward":"forward";let Te=P[0]===P[1]&&P[0]<j;D==="backward"&&!Te&&(ne=-1)}M=ne+I,O=ne+I+1}}M!==-1&&O!==-1&&M!==O&&p.current.setSelectionRange(M,O,D)}let ve=M!==-1?M:s,he=O!==-1?O:v,Me=D??K;z(ve),q(he),J.current.prev=[ve,he,Me]}if(document.addEventListener("selectionchange",m,{capture:!0}),m(),document.activeElement===n&&ee(!0),!document.getElementById("input-otp-style")){let s=document.createElement("style");if(s.id="input-otp-style",document.head.appendChild(s),s.sheet){let v="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Y(s.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Y(s.sheet,`[data-input-otp]:autofill { ${v} }`),Y(s.sheet,`[data-input-otp]:-webkit-autofill { ${v} }`),Y(s.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Y(s.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let b=()=>{a&&a.style.setProperty("--root-height",`${n.clientHeight}px`)};b();let x=new ResizeObserver(b);return x.observe(n),()=>{document.removeEventListener("selectionchange",m,{capture:!0}),x.disconnect()}},[]);let[ue,ce]=r.useState(!1),[$,ee]=r.useState(!1),[T,z]=r.useState(null),[B,q]=r.useState(null);r.useEffect(()=>{Ye(()=>{var n,a,m,b;(n=p.current)==null||n.dispatchEvent(new Event("input"));let x=(a=p.current)==null?void 0:a.selectionStart,s=(m=p.current)==null?void 0:m.selectionEnd,v=(b=p.current)==null?void 0:b.selectionDirection;x!==null&&s!==null&&(z(x),q(s),J.current.prev=[x,s,v])})},[d,$]),r.useEffect(()=>{R!==void 0&&d!==R&&R.length<i&&d.length===i&&H?.(d)},[i,H,R,d]);let W=Ue({containerRef:U,inputRef:p,pushPasswordManagerStrategy:F,isFocused:$}),de=r.useCallback(n=>{let a=n.currentTarget.value.slice(0,i);if(a.length>0&&E&&!E.test(a)){n.preventDefault();return}typeof R=="string"&&a.length<R.length&&document.dispatchEvent(new Event("selectionchange")),G(a)},[i,G,R,E]),pe=r.useCallback(()=>{var n;if(p.current){let a=Math.min(p.current.value.length,i-1),m=p.current.value.length;(n=p.current)==null||n.setSelectionRange(a,m),z(a),q(m)}ee(!0)},[i]),me=r.useCallback(n=>{var a,m;let b=p.current;if(!g&&(!X.current.isIOS||!n.clipboardData||!b))return;let x=n.clipboardData.getData("text/plain"),s=g?g(x):x;n.preventDefault();let v=(a=p.current)==null?void 0:a.selectionStart,K=(m=p.current)==null?void 0:m.selectionEnd,j=(v!==K?d.slice(0,v)+s+d.slice(K):d.slice(0,v)+s+d.slice(v)).slice(0,i);if(j.length>0&&E&&!E.test(j))return;b.value=j,G(j);let N=Math.min(j.length,i-1),P=j.length;b.setSelectionRange(N,P),z(N),q(P)},[i,G,E,d]),Ce=r.useMemo(()=>({position:"relative",cursor:c.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[c.disabled]),fe=r.useMemo(()=>({position:"absolute",inset:0,width:W.willPushPWMBadge?`calc(100% + ${W.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:W.willPushPWMBadge?`inset(0 ${W.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:h,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[W.PWM_BADGE_SPACE_WIDTH,W.willPushPWMBadge,h]),Pe=r.useMemo(()=>r.createElement("input",ze($e({autoComplete:c.autoComplete||"one-time-code"},c),{"data-input-otp":!0,"data-input-otp-placeholder-shown":d.length===0||void 0,"data-input-otp-mss":T,"data-input-otp-mse":B,inputMode:L,pattern:E?.source,"aria-placeholder":y,style:fe,maxLength:i,value:d,ref:p,onPaste:n=>{var a;me(n),(a=c.onPaste)==null||a.call(c,n)},onChange:de,onMouseOver:n=>{var a;ce(!0),(a=c.onMouseOver)==null||a.call(c,n)},onMouseLeave:n=>{var a;ce(!1),(a=c.onMouseLeave)==null||a.call(c,n)},onFocus:n=>{var a;pe(),(a=c.onFocus)==null||a.call(c,n)},onBlur:n=>{var a;ee(!1),(a=c.onBlur)==null||a.call(c,n)}})),[de,pe,me,L,fe,i,B,T,c,E?.source,d]),te=r.useMemo(()=>({slots:Array.from({length:i}).map((n,a)=>{var m;let b=$&&T!==null&&B!==null&&(T===B&&a===T||a>=T&&a<B),x=d[a]!==void 0?d[a]:null,s=d[0]!==void 0?null:(m=y?.[a])!=null?m:null;return{char:x,placeholderChar:s,isActive:b,hasFakeCaret:b&&x===null}}),isFocused:$,isHovering:!c.disabled&&ue}),[$,ue,i,B,T,c.disabled,d]),ke=r.useMemo(()=>C?C(te):r.createElement(je.Provider,{value:te},A),[A,te,C]);return r.createElement(r.Fragment,null,w!==null&&r.createElement("noscript",null,r.createElement("style",null,w)),r.createElement("div",{ref:U,"data-input-otp-container":!0,style:Ce,className:k},ke,r.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Pe)))});Se.displayName="Input";function Y(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Xe=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function et({className:e,containerClassName:t,...l}){return o.jsx(Se,{"data-slot":"input-otp",containerClassName:Z("flex items-center gap-2 has-disabled:opacity-50",t),className:Z("disabled:cursor-not-allowed",e),...l})}function tt({className:e,...t}){return o.jsx("div",{"data-slot":"input-otp-group",className:Z("flex items-center",e),...t})}function _({index:e,className:t,...l}){const u=r.useContext(je),{char:f,hasFakeCaret:i,isActive:h}=u?.slots[e]??{};return o.jsxs("div",{"data-slot":"input-otp-slot","data-active":h,className:Z("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",t),...l,children:[f,i&&o.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:o.jsx("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}const nt=De({code:Ie()});function rt({field:e}){return o.jsxs(o.Fragment,{children:[e.state.meta.isTouched&&!e.state.meta.isValid?o.jsx("em",{children:e.state.meta.errors.map(t=>t.message).join(",")}):null,e.state.meta.isValidating?"Validating...":null]})}function at({email:e,className:t,...l}){const u=Ne(),f=We({defaultValues:{code:""},validators:{onSubmit:nt},onSubmit:async({value:i})=>{const{error:h}=await re.emailOtp.checkVerificationOtp({email:e,type:"sign-in",otp:i.code});if(h){console.error(h),ae.error("Invalid code");return}const{error:S}=await re.emailOtp.verifyEmail({email:e,otp:i.code});if(S){console.error(S),ae.error("Your email could not be verified at this time");return}const{error:y}=await re.signIn.emailOtp({email:e,otp:i.code});if(y){console.error(y),ae.error("Authentication failed");return}u({to:"/"})}});return o.jsx("div",{className:Z("flex flex-col gap-6",t),...l,children:o.jsx(_e,{className:"overflow-hidden p-0",children:o.jsxs(Le,{className:"grid p-0 md:grid-cols-2",children:[o.jsx("form",{className:"p-6 md:p-8",onSubmit:i=>{i.preventDefault(),i.stopPropagation(),f.handleSubmit()},children:o.jsxs("div",{className:"flex flex-col gap-6",children:[o.jsx("div",{className:"flex flex-col items-center text-center",children:o.jsx("h1",{className:"text-2xl font-bold",children:"Verify your email"})}),o.jsx("div",{className:"grid gap-3",children:o.jsx(f.Field,{name:"code",children:i=>o.jsxs(o.Fragment,{children:[o.jsx(Ae,{htmlFor:i.name,children:"Code"}),o.jsx(et,{maxLength:6,children:o.jsxs(tt,{children:[o.jsx(_,{index:0}),o.jsx(_,{index:1}),o.jsx(_,{index:2}),o.jsx(_,{index:3}),o.jsx(_,{index:4}),o.jsx(_,{index:5})]})}),o.jsx(rt,{field:i})]})})}),o.jsx(f.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting],children:([i,h])=>o.jsx(Be,{type:"submit",disabled:!i,className:"w-full",children:h?"...":"Submit"})})]})}),o.jsx("div",{className:"bg-muted relative hidden md:block",children:o.jsx("img",{src:"/placeholder.svg",alt:"Image",className:"absolute inset-0 h-full w-full object-cover dark:brightness-[0.2] dark:grayscale"})})]})})})}const st=function(){const{email:t}=Fe.useSearch();return o.jsx(at,{email:t})};export{st as component};
